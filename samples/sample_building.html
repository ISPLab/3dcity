<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <script src="https://cesium.com/downloads/cesiumjs/releases/1.108/Build/Cesium/Cesium.js" defer></script>
  <link href="https://cesium.com/downloads/cesiumjs/releases/1.108/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
  <style>
    html, body, #cesiumContainer {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden;
    }
  </style>
</head>
<body>
  <div id="cesiumContainer"></div>
  <script>
    // Check if Cesium is loaded and retry if not
    function initCesium() {
      if (typeof Cesium === 'undefined') {
        // If Cesium is not yet defined, wait and try again
        setTimeout(initCesium, 100);
        return;
      }
      
      // Cesium is loaded, now we can use it
      Cesium.Ion.defaultAccessToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIzNjYxMTIwYS03YTdiLTQzY2MtYTU4My03ZDcxMWQ5NGU1OTciLCJpZCI6MTQ4NTM4LCJpYXQiOjE2ODc0NDY4OTF9.FcxwaPOxnu1bOjdgn566NDjJxj391dUfiDTf2GJpCpw';

      const viewer = new Cesium.Viewer("cesiumContainer", {
        infoBox: false,
        selectionIndicator: false,
        shadows: true,
        shouldAnimate: true,
      });

      function createModel(url, height) {
        viewer.entities.removeAll();

        // You can adjust these coordinates to place your buildings in a specific location
        const position = Cesium.Cartesian3.fromDegrees(
          -123.0744619,  // longitude
          44.0503706,    // latitude
          height,        // height
        );
        const heading = Cesium.Math.toRadians(135);
        const pitch = 0;
        const roll = 0;
        const hpr = new Cesium.HeadingPitchRoll(heading, pitch, roll);
        const orientation = Cesium.Transforms.headingPitchRollQuaternion(position, hpr);

        const entity = viewer.entities.add({
          name: "Sample Buildings",
          position: position,
          orientation: orientation,
          model: {
            uri: url,
            minimumPixelSize: 128,
            maximumScale: 20000,
          },
        });
        viewer.trackedEntity = entity;
      }

      // Use the GitHub download URL for your model (using /raw/ instead of /blob/)
      // Or use the local path if testing locally
      const modelUrl = "./sample_buildings.glb";
      // Alternatively, if using local server: "http://localhost:8000/samples/sample_buildings.glb"
      
      // Set the height value appropriate for your model
      createModel(modelUrl, 0);
    }

    // Start the initialization process when page loads
    window.onload = initCesium;
  </script>
</body>
</html>